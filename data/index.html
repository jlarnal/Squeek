<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Squeek</title>
<style>
body { font-family: system-ui, sans-serif; max-width: 480px; margin: 2em auto; padding: 0 1em; background: #1a1a2e; color: #e0e0e0; }
h1 { color: #00d4ff; }
.status { padding: 0.5em; border-radius: 4px; margin: 1em 0; }
.ok { background: #1b3a2a; border: 1px solid #2d6a3e; }
.err { background: #3a1b1b; border: 1px solid #6a2d2d; }
.wait { background: #3a3a1b; border: 1px solid #6a6a2d; }
pre { background: #0d0d1a; padding: 1em; border-radius: 4px; overflow-x: auto; font-size: 0.85em; max-height: 200px; overflow-y: auto; }
</style>
</head>
<body>
<h1>Squeek</h1>
<p>Phase 5A — Infrastructure verification</p>

<div id="ws" class="status wait">WebSocket: connecting...</div>
<div id="fs" class="status wait">LittleFS: this page loaded from flash</div>

<h3>WebSocket log</h3>
<pre id="log"></pre>

<script>
var logEl = document.getElementById('log');
var wsEl = document.getElementById('ws');

function log(msg) {
  var d = new Date().toLocaleTimeString();
  logEl.textContent = d + ' ' + msg + '\n' + logEl.textContent;
}

function connect() {
  var ws = new WebSocket('ws://' + location.host + '/ws');
  ws.onopen = function() {
    wsEl.textContent = 'WebSocket: connected';
    wsEl.className = 'status ok';
    log('connected');
    ws.send(JSON.stringify({cmd:'ping'}));
  };
  ws.onclose = function() {
    wsEl.textContent = 'WebSocket: disconnected — reconnecting in 3s...';
    wsEl.className = 'status err';
    log('disconnected');
    setTimeout(connect, 3000);
  };
  ws.onmessage = function(e) {
    log('recv: ' + e.data);
  };
  ws.onerror = function() {
    log('error');
  };
}

document.getElementById('fs').className = 'status ok';
connect();
</script>
</body>
</html>
